# 安全政策

## 🔒 支持的版本

当前支持的 LoulanKey 版本：

| 版本 | 支持状态 | 安全更新 |
|------|---------|---------|
| 1.0.x | ✅ 支持 | ✅ 是 |
| < 1.0 | ❌ 不支持 | ❌ 否 |

## 🚨 报告安全漏洞

我们非常重视安全问题。如果你发现了安全漏洞，请**不要**公开讨论。

### 报告流程

1. **发送邮件**
   - 邮箱: security@loulankey.com
   - 主题: [SECURITY] 简短描述

2. **包含信息**
   - 漏洞类型和严重程度
   - 详细的复现步骤
   - 受影响的版本
   - 可能的影响范围
   - 你的联系方式

3. **我们的承诺**
   - 48 小时内确认收到
   - 7 天内提供初步评估
   - 30 天内发布修复（严重漏洞会加快）
   - 在修复发布前保密

4. **漏洞奖励**
   - 严重漏洞: $500-2000
   - 中等漏洞: $100-500
   - 低危漏洞: 致谢名单

### 漏洞严重程度

| 等级 | 描述 | 示例 |
|------|------|------|
| 🔴 严重 | 可远程执行代码或提取密钥 | Secure Boot 绕过 |
| 🟠 高危 | 可绕过安全机制 | PIN 暴力破解 |
| 🟡 中危 | 可导致拒绝服务 | 崩溃漏洞 |
| 🟢 低危 | 信息泄露 | 版本信息暴露 |

## 🛡️ 安全特性

### 已实现的防护

- ✅ Secure Boot V2 (RSA-3072)
- ✅ Flash 加密 (AES-256-XTS)
- ✅ eFuse 密钥保护
- ✅ JTAG 禁用
- ✅ PIN 重试限制
- ✅ 防回滚保护
- ✅ 看门狗保护

### 威胁模型

我们考虑以下攻击场景：

1. **物理访问攻击**
   - Flash 读取 → ✅ 加密防护
   - JTAG 调试 → ✅ 已禁用
   - 芯片去封装 → ✅ eFuse 保护

2. **软件攻击**
   - 固件篡改 → ✅ Secure Boot
   - 恶意固件 → ✅ 签名验证
   - 版本降级 → ✅ 防回滚

3. **侧信道攻击**
   - 时序分析 → ✅ 硬件签名
   - 功耗分析 → ⚠️ 需要额外措施
   - 电磁辐射 → ⚠️ 需要额外措施

4. **网络攻击**
   - 中间人攻击 → ✅ FIDO2 协议保护
   - 钓鱼攻击 → ✅ 域名绑定

## 📋 安全检查清单

### 开发者

- [ ] 所有输入都经过验证
- [ ] 使用安全的加密算法
- [ ] 敏感数据及时清零
- [ ] 正确处理错误条件
- [ ] 避免时序侧信道
- [ ] 通过安全测试

### 用户

- [ ] 从官方渠道下载固件
- [ ] 验证固件签名
- [ ] 使用强 PIN 码
- [ ] 定期更新固件
- [ ] 物理保护设备

## 🔐 密钥管理

### 生产密钥

- 签名密钥必须离线存储
- 使用 HSM 或硬件密钥
- 定期轮换密钥
- 严格的访问控制

### 用户密钥

- 所有密钥存储在 eFuse
- 密钥不可导出
- 使用 MKEK 加密
- 设备唯一

## 📜 合规性

LoulanKey 致力于符合以下标准：

- ✅ FIDO2 Authenticator Security Requirements
- ⚠️ FIPS 140-2 Level 1 (部分)
- ⏳ Common Criteria EAL4+ (计划中)

## 🔄 安全更新

### 获取更新

- GitHub Releases
- 自动 OTA 通知
- 安全公告邮件列表

### 更新流程

1. 查看更新日志
2. 下载签名固件
3. 验证签名
4. 通过 OTA 更新
5. 验证版本

## 📞 联系方式

- 安全团队: security@loulankey.com
- PGP 公钥: [下载](https://loulankey.com/pgp-key.asc)
- Bug Bounty: https://loulankey.com/security/bounty

## 🎓 负责任披露

我们遵循负责任披露原则：

1. 研究者私下报告漏洞
2. 我们确认并修复
3. 发布安全补丁
4. 90 天后公开披露
5. 致谢研究者

## 📊 安全审计

LoulanKey 定期进行安全审计：

- 内部代码审查: 每次提交
- 外部安全审计: 每年一次
- 渗透测试: 每季度一次

审计报告摘要会公开发布。

---

**最后更新**: 2024-12-04  
**版本**: 1.0
